import { Component, Input } from '@angular/core';
import { DatePipe } from '@angular/common';
import { PoInfoOrientation } from '@po-ui/ng-components';
export class PoPageJobSchedulerSummaryComponent {
    constructor(datePipe) {
        this.datePipe = datePipe;
        this.executionValue = '';
        this.firstExecutionValue = '';
        this.infoOrientation = PoInfoOrientation.Horizontal;
        this.periodicityValue = '';
        this.recurrentValue = '';
        this.literals = {};
        this.parameters = [];
        this.value = {};
    }
    ngOnInit() {
        const { periodicity, hour, dayOfMonth, daysOfWeek, recurrent, firstExecution, firstExecutionHour } = this.value;
        this.periodicityValue = this.getPeriodicityLabel(periodicity);
        this.executionValue = this.getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth);
        this.firstExecutionValue = this.getFirstExecutionLabel(firstExecution, firstExecutionHour);
        this.recurrentValue = this.getRecurrentValue(recurrent);
    }
    getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth) {
        switch (periodicity) {
            case 'daily':
                return this.getHourLabel(hour);
            case 'monthly':
                return this.getMonthlyLabelExecution(dayOfMonth, hour);
            case 'weekly':
                return this.getWeeklyLabelExecution(daysOfWeek, hour);
            default:
                return this.literals.notReported;
        }
    }
    getFirstExecutionLabel(firstExecution, firstExecutionHour) {
        if (firstExecution) {
            const date = this.datePipe.transform(firstExecution, 'dd/MM/yyyy', '-0200');
            return `${date} ${this.getHourLabel(firstExecutionHour)}`;
        }
        else {
            return this.literals.notReported;
        }
    }
    getHourLabel(hour) {
        return `${this.literals.at} ${hour || '00:00'}h`;
    }
    getMonthlyLabelExecution(dayOfMonth, hour) {
        const hourLabel = this.getHourLabel(hour);
        return `${this.literals.day} ${dayOfMonth} ${hourLabel}`;
    }
    getPeriodicityLabel(periodicity) {
        switch (periodicity) {
            case 'daily':
                return this.literals.daily;
            case 'monthly':
                return this.literals.monthly;
            case 'weekly':
                return this.literals.weekly;
            default:
                return this.literals.single;
        }
    }
    getRecurrentValue(recurrent) {
        return recurrent ? this.literals.yes : this.literals.no;
    }
    getSorterWeekDays() {
        return {
            'sunday': 0,
            'monday': 1,
            'tuesday': 2,
            'wednesday': 3,
            'thursday': 4,
            'friday': 5,
            'saturday': 6
        };
    }
    getTranslateWeekDay(day) {
        const days = {
            Sunday: this.literals.sunday,
            Monday: this.literals.monday,
            Tuesday: this.literals.tuesday,
            Wednesday: this.literals.wednesday,
            Thursday: this.literals.thursday,
            Friday: this.literals.friday,
            Saturday: this.literals.saturday
        };
        return days[day] || '';
    }
    getWeekDaysLabel(days = []) {
        const weekDaysSorted = this.sortWeekDays(days);
        return weekDaysSorted.map(day => this.getTranslateWeekDay(day)).join(', ');
    }
    getWeeklyLabelExecution(daysOfWeek, hour) {
        if (daysOfWeek && Array.isArray(daysOfWeek)) {
            return `${this.getWeekDaysLabel(daysOfWeek)} ${this.getHourLabel(hour)}`;
        }
        else {
            return this.literals.notReported;
        }
    }
    sortWeekDays(days = []) {
        const sorterWeekDays = this.getSorterWeekDays();
        return days.sort((a, b) => {
            const currDay = a.toLowerCase();
            const nextDay = b.toLowerCase();
            return sorterWeekDays[currDay] > sorterWeekDays[nextDay] ? 1 : -1;
        });
    }
}
PoPageJobSchedulerSummaryComponent.decorators = [
    { type: Component, args: [{
                selector: 'po-page-job-scheduler-summary',
                template: "<div class=\"po-md-12\">\n  <po-info [p-label]=\"literals.process\" [p-orientation]=\"infoOrientation\" [p-value]=\"value.processID\"> </po-info>\n\n  <po-info [p-label]=\"literals.periodicity\" [p-orientation]=\"infoOrientation\" [p-value]=\"periodicityValue\"> </po-info>\n\n  <po-info\n    *ngIf=\"value.periodicity !== 'single'\"\n    [p-label]=\"literals.execution\"\n    [p-orientation]=\"infoOrientation\"\n    [p-value]=\"executionValue\"\n  >\n  </po-info>\n\n  <po-info [p-label]=\"literals.recurrent\" [p-orientation]=\"infoOrientation\" [p-value]=\"recurrentValue\"> </po-info>\n\n  <po-info [p-label]=\"literals.firstExecution\" [p-orientation]=\"infoOrientation\" [p-value]=\"firstExecutionValue\">\n  </po-info>\n</div>\n\n<po-widget *ngIf=\"parameters && parameters.length\" class=\"po-pt-1 po-pb-1 po-md-12\" [p-title]=\"literals.parameters\">\n  <po-dynamic-view [p-fields]=\"parameters\" [p-value]=\"value.executionParameter\"> </po-dynamic-view>\n</po-widget>\n"
            },] }
];
PoPageJobSchedulerSummaryComponent.ctorParameters = () => [
    { type: DatePipe }
];
PoPageJobSchedulerSummaryComponent.propDecorators = {
    literals: [{ type: Input, args: ['p-literals',] }],
    parameters: [{ type: Input, args: ['p-parameters',] }],
    value: [{ type: Input, args: ['p-value',] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdGVtcGxhdGVzL3NyYy9saWIvY29tcG9uZW50cy9wby1wYWdlLWpvYi1zY2hlZHVsZXIvcG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkvcG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUUzQyxPQUFPLEVBQXNCLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFRN0UsTUFBTSxPQUFPLGtDQUFrQztJQWE3QyxZQUFvQixRQUFrQjtRQUFsQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBWnRDLG1CQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLHdCQUFtQixHQUFHLEVBQUUsQ0FBQztRQUN6QixvQkFBZSxHQUFHLGlCQUFpQixDQUFDLFVBQVUsQ0FBQztRQUMvQyxxQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDdEIsbUJBQWMsR0FBRyxFQUFFLENBQUM7UUFFQyxhQUFRLEdBQVEsRUFBRSxDQUFDO1FBRWpCLGVBQVUsR0FBOEIsRUFBRSxDQUFDO1FBRWhELFVBQUssR0FBZ0MsRUFBRSxDQUFDO0lBRWpCLENBQUM7SUFFMUMsUUFBUTtRQUNOLE1BQU0sRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLGNBQWMsRUFBRSxrQkFBa0IsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFFaEgsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMs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LENBQUMsQ0FBQyxDQUFTLEVBQUUsQ0FBUyxFQUFFLEVBQUU7WUFDeEMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUVoQyxPQUFPLGNBQWMsQ0FBQyxPQUFPLENBQUMsR0FBRyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDOzs7WUEvSEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSwrQkFBK0I7Z0JBQ3pDLGkrQkFBMkQ7YUFDNUQ7OztZQVRRLFFBQVE7Ozt1QkFpQmQsS0FBSyxTQUFDLFlBQVk7eUJBRWxCLEtBQUssU0FBQyxjQUFjO29CQUVwQixLQUFLLFNBQUMsU0FBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRGF0ZVBpcGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuXG5pbXBvcnQgeyBQb0R5bmFtaWNWaWV3RmllbGQsIFBvSW5mb09yaWVudGF0aW9uIH0gZnJvbSAnQHBvLXVpL25nLWNvbXBvbmVudHMnO1xuXG5pbXBvcnQgeyBQb0pvYlNjaGVkdWxlckludGVybmFsIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9wby1qb2Itc2NoZWR1bGVyLWludGVybmFsLmludGVyZmFjZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3BvLXBhZ2Utam9iLXNjaGVkdWxlci1zdW1tYXJ5JyxcbiAgdGVtcGxhdGVVcmw6ICdwby1wYWdlLWpvYi1zY2hlZHVsZXItc3VtbWFyeS5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgUG9QYWdlSm9iU2NoZWR1bGVyU3VtbWFyeUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIGV4ZWN1dGlvblZhbHVlID0gJyc7XG4gIGZpcnN0RXhlY3V0aW9uVmFsdWUgPSAnJztcbiAgaW5mb09yaWVudGF0aW9uID0gUG9JbmZvT3JpZW50YXRpb24uSG9yaXpvbnRhbDtcbiAgcGVyaW9kaWNpdHlWYWx1ZSA9ICcnO1xuICByZWN1cnJlbnRWYWx1ZSA9ICcnO1xuXG4gIEBJbnB1dCgncC1saXRlcmFscycpIGxpdGVyYWxzID0gPGFueT57fTtcblxuICBASW5wdXQoJ3AtcGFyYW1ldGVycycpIHBhcmFtZXRlcnM6IEFycmF5PFBvRHluYW1pY1ZpZXdGaWVsZD4gPSBbXTtcblxuICBASW5wdXQoJ3AtdmFsdWUnKSB2YWx1ZTogUG9Kb2JTY2hlZHVsZXJJbnRlcm5hbCA9IDxhbnk+e307XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBkYXRlUGlwZTogRGF0ZVBpcGUpIHt9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgY29uc3QgeyBwZXJpb2RpY2l0eSwgaG91ciwgZGF5T2ZNb250aCwgZGF5c09mV2VlaywgcmVjdXJyZW50LCBmaXJzdEV4ZWN1dGlvbiwgZmlyc3RFeGVjdXRpb25Ib3VyIH0gPSB0aGlzLnZhbHVlO1xuXG4gICAgdGhpcy5wZXJpb2RpY2l0eVZhbHVlID0gdGhpcy5nZXRQZXJpb2RpY2l0eUxhYmVsKHBlcmlvZGljaXR5KTtcbiAgICB0aGlzLmV4ZWN1dGlvblZhbHVlID0gdGhpcy5nZXRFeGVjdXRpb25WYWx1ZShwZXJpb2RpY2l0eSwgaG91ciwgZGF5c09mV2VlaywgZGF5T2ZNb250aCk7XG4gICAgdGhpcy5maXJzdEV4ZWN1dGlvblZhbHVlID0gdGhpcy5nZXRGaXJzdEV4ZWN1dGlvbkxhYmVsKGZpcnN0RXhlY3V0aW9uLCBmaXJzdEV4ZWN1dGlvbkhvdXIpO1xuICAgIHRoaXMucmVjdXJyZW50VmFsdWUgPSB0aGlzLmdldFJlY3VycmVudFZhbHVlKHJlY3VycmVudCk7XG4gIH1cblxuICBwcml2YXRlIGdldEV4ZWN1dGlvblZhbHVlKHBlcmlvZGljaXR5OiBzdHJpbmcsIGhvdXI/OiBzdHJpbmcsIGRheXNPZldlZWs/OiBBcnJheTxzdHJpbmc+LCBkYXlPZk1vbnRoPzogbnVtYmVyKSB7XG4gICAgc3dpdGNoIChwZXJpb2RpY2l0eSkge1xuICAgICAgY2FzZSAnZGFpbHknOlxuICAgICAgICByZXR1cm4gdGhpcy5nZXRIb3VyTGFiZWwoaG91cik7XG4gICAgICBjYXNlICdtb250aGx5JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TW9udGhseUxhYmVsRXhlY3V0aW9uKGRheU9mTW9udGgsIGhvdXIpO1xuICAgICAgY2FzZSAnd2Vla2x5JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2Vla2x5TGFiZWxFeGVjdXRpb24oZGF5c09mV2VlaywgaG91cik7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5ub3RSZXBvcnRlZDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEZpcnN0RXhlY3V0aW9uTGFiZWwoZmlyc3RFeGVjdXRpb246IERhdGUsIGZpcnN0RXhlY3V0aW9uSG91cj86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKGZpcnN0RXhlY3V0aW9uKSB7XG4gICAgICBjb25zdCBkYXRlID0gdGhpcy5kYXRlUGlwZS50cmFuc2Zvcm0oZmlyc3RFeGVjdXRpb24sICdkZC9NTS95eXl5JywgJy0wMjAwJyk7XG5cbiAgICAgIHJldHVybiBgJHtkYXRlfSAke3RoaXMuZ2V0SG91ckxhYmVsKGZpcnN0RXhlY3V0aW9uSG91cil9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMubGl0ZXJhbHMubm90UmVwb3J0ZWQ7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRIb3VyTGFiZWwoaG91cjogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGAke3RoaXMubGl0ZXJhbHMuYXR9ICR7aG91ciB8fCAnMDA6MDAnfWhgO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRNb250aGx5TGFiZWxFeGVjdXRpb24oZGF5T2ZNb250aDogbnVtYmVyLCBob3VyOiBzdHJpbmcpIHtcbiAgICBjb25zdCBob3VyTGFiZWwgPSB0aGlzLmdldEhvdXJMYWJlbChob3VyKTtcblxuICAgIHJldHVybiBgJHt0aGlzLmxpdGVyYWxzLmRheX0gJHtkYXlPZk1vbnRofSAke2hvdXJMYWJlbH1gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRQZXJpb2RpY2l0eUxhYmVsKHBlcmlvZGljaXR5KSB7XG4gICAgc3dpdGNoIChwZXJpb2RpY2l0eSkge1xuICAgICAgY2FzZSAnZGFpbHknOlxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5kYWlseTtcbiAgICAgIGNhc2UgJ21vbnRobHknOlxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5tb250aGx5O1xuICAgICAgY2FzZSAnd2Vla2x5JzpcbiAgICAgICAgcmV0dXJuIHRoaXMubGl0ZXJhbHMud2Vla2x5O1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHRoaXMubGl0ZXJhbHMuc2luZ2xlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0UmVjdXJyZW50VmFsdWUocmVjdXJyZW50OiBib29sZWFuKTogc3RyaW5nIHtcbiAgICByZXR1cm4gcmVjdXJyZW50ID8gdGhpcy5saXRlcmFscy55ZXMgOiB0aGlzLmxpdGVyYWxzLm5vO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRTb3J0ZXJXZWVrRGF5cygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ3N1bmRheSc6IDAsXG4gICAgICAnbW9uZGF5JzogMSxcbiAgICAgICd0dWVzZGF5JzogMixcbiAgICAgICd3ZWRuZXNkYXknOiAzLFxuICAgICAgJ3RodXJzZGF5JzogNCxcbiAgICAgICdmcmlkYXknOiA1LFxuICAgICAgJ3NhdHVyZGF5JzogNlxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdldFRyYW5zbGF0ZVdlZWtEYXkoZGF5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRheXMgPSB7XG4gICAgICBTdW5kYXk6IHRoaXMubGl0ZXJhbHMuc3VuZGF5LFxuICAgICAgTW9uZGF5OiB0aGlzLmxpdGVyYWxzLm1vbmRheSxcbiAgICAgIFR1ZXNkYXk6IHRoaXMubGl0ZXJhbHMudHVlc2RheSxcbiAgICAgIFdlZG5lc2RheTogdGhpcy5saXRlcmFscy53ZWRuZXNkYXksXG4gICAgICBUaHVyc2RheTogdGhpcy5saXRlcmFscy50aHVyc2RheSxcbiAgICAgIEZyaWRheTogdGhpcy5saXRlcmFscy5mcmlkYXksXG4gICAgICBTYXR1cmRheTogdGhpcy5saXRlcmFscy5zYXR1cmRheVxuICAgIH07XG5cbiAgICByZXR1cm4gZGF5c1tkYXldIHx8ICcnO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRXZWVrRGF5c0xhYmVsKGRheXM6IEFycmF5PHN0cmluZz4gPSBbXSk6IHN0cmluZyB7XG4gICAgY29uc3Qgd2Vla0RheXNTb3J0ZWQgPSB0aGlzLnNvcnRXZWVrRGF5cyhkYXlzKTtcblxuICAgIHJldHVybiB3ZWVrRGF5c1NvcnRlZC5tYXAoZGF5ID0+IHRoaXMuZ2V0VHJhbnNsYXRlV2Vla0RheShkYXkpKS5qb2luKCcsICcpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRXZWVrbHlMYWJlbEV4ZWN1dGlvbihkYXlzT2ZXZWVrOiBBcnJheTxzdHJpbmc+LCBob3VyOiBzdHJpbmcpIHtcbiAgICBpZiAoZGF5c09mV2VlayAmJiBBcnJheS5pc0FycmF5KGRheXNPZldlZWspKSB7XG4gICAgICByZXR1cm4gYCR7dGhpcy5nZXRXZWVrRGF5c0xhYmVsKGRheXNPZldlZWspfSAke3RoaXMuZ2V0SG91ckxhYmVsKGhvdXIpfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLm5vdFJlcG9ydGVkO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc29ydFdlZWtEYXlzKGRheXM6IEFycmF5PHN0cmluZz4gPSBbXSkge1xuICAgIGNvbnN0IHNvcnRlcldlZWtEYXlzID0gdGhpcy5nZXRTb3J0ZXJXZWVrRGF5cygpO1xuXG4gICAgcmV0dXJuIGRheXMuc29ydCgoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJEYXkgPSBhLnRvTG93ZXJDYXNlKCk7XG4gICAgICBjb25zdCBuZXh0RGF5ID0gYi50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICByZXR1cm4gc29ydGVyV2Vla0RheXNbY3VyckRheV0gPiBzb3J0ZXJXZWVrRGF5c1tuZXh0RGF5XSA/IDEgOiAtMTtcbiAgICB9KTtcbiAgfVxufVxuIl19